!function(e){function t(a){if(l[a])return l[a].exports;var r=l[a]={exports:{},id:a,loaded:!1};return e[a].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var l={};return t.m=e,t.c=l,t.p="",t(0)}([function(e,t,l){l(1)},function(e,t,l){!function(e,t,a){function r(e){var l=this;l.el=e,l.name=e.getAttribute("automate-form").split("."),l.instance=l.name[0],l.name=l.name[1],l.filesUploaded=!1,l._fieldTypes={string:n,integer:o,decimal:p,boolean:c,file:u,choice:d,date:f},l.getFormRequest=h({url:l.getUrlBase()+"/api/v1/forms/get_form?form_name="+l.name}).success(function(e){var a=v(),r=t.createElement("input");if(r.setAttribute("type","hidden"),r.setAttribute("name","_submission_guid"),r.value=a,l.el.appendChild(r),l._submissionField=r,e.fields&&e.fields.length>0){for(var i=0;i<e.fields.length;i++)l.addField(e.fields[i]);l.submitEl=t.createElement("button"),l.submitEl.setAttribute("type","submit"),l.submitEl.classList.add(s.prefixClass("button")),l.submitEl.classList.add(s.prefixClass("submit-button"));var n=t.createElement("span");n.classList.add(s.prefixClass("button-text")),n.innerText="Submit",l.submitEl.appendChild(n);var o=t.createElement("span");o.classList.add(s.prefixClass("spinner")),l.submitEl.appendChild(o),l.el.appendChild(l.submitEl)}}),l.el.addEventListener("submit",function(e){l._onSubmit.call(l,e)})}function i(){for(var e=["form[automate-form]"],l=[],a=0;a<e.length;a++){var i=t.querySelectorAll(e[a]);i&&(l=l.concat(Array.prototype.slice.call(i)))}for(var a=0;a<l.length;a++){new r(l[a])}}var s=l(2),n=l(3),o=l(6),p=l(7),c=l(8),d=l(10),u=l(13),f=l(14),h=l(15),v=l(16);r.prototype._onSubmit=function(e){e&&e.preventDefault();var t=this;t.submitEl.setAttribute("disabled","");var l={},a=0;for(n in t.fields)"file"==t.fields[n].type&&t.fields[n]._field.el.files.length>0&&(l[t.fields[n].key]=t.fields[n],a++);if(console.log(a),a>0&&!t.filesUploaded){console.log("there are files to submit!");var r=new FormData;r.set("_submission_guid",t._submissionField.value);for(n in l)for(var i=l[n]._field.el,s=0;s<i.files.length;s++)console.log(i.files[s]),r.append(n,i.files[s],i.files[s].name);t.submitFileRequest=h({method:"POST",url:t.getFileUrl(),data:r}).success(function(e){t._appendResponse(e),t.filesUploaded=!0,t._onSubmit()})}else{console.log("There are no files to submit");var r={};r._submission_guid=t._submissionField.value;for(fieldName in t.fields){var n=t.fields[fieldName];r[fieldName]=n._field.value}t.sumbitFormRequest=h({method:"POST",url:t.getPostUrl(),data:JSON.stringify(r),headers:{"Content-Type":"application/json"}}).success(function(e){t.submitEl.removeAttribute("disabled"),t._appendResponse(e),t.filesUploaded=!1,t._submissionField.value=v()})}},r.prototype.getUrlBase=function(){return"https://"+this.instance+".nebrios.com"},r.prototype.getPostUrl=function(){return this.getUrlBase()+"/api/v1/forms/post_form"},r.prototype.getFileUrl=function(){return this.getUrlBase()+"/api/v1/forms/file_upload"},r.prototype._appendResponse=function(e){var l=this,a=t.createElement("pre"),r=t.createElement("code");r.innerText=JSON.stringify(e,null,2),a.classList.add(s.prefixClass("response-preview")),a.appendChild(r),l.el.appendChild(a)},r.prototype.addField=function(e){var t=this;if(t.fields=t.fields||{},t.fields[e.key]=e,t._fieldTypes[e.type]){var l=new t._fieldTypes[e.type](e);t.el.appendChild(l.wrapperEl),t.fields[e.key]._field=l,delete t.fields[e.key].val}else console.warn("Couldn't create a field for the type \""+e.type+'".')},e.AutomateForm=r,"loading"!==t.readyState?i():t.addEventListener("DOMContentLoaded",i)}(window,window.document)},function(e,t){var l={};l.cssClassPrefix="af-",l.prefixClass=function(e){return l.cssClassPrefix+e},e.exports=l},function(e,t,l){function a(e){var t=this;i.call(t,e),t.el.setAttribute("type","text"),t.el.classList.add(r.prefixClass("field--string"))}var r=l(2),i=l(4);a.prototype=Object.create(i.prototype),a.prototype.constructor=a,e.exports=a},function(e,t,l){function a(e){var t=this;i.call(t,e),t.el.addEventListener("focus",function(e){t._onFieldFocus.call(t,e)}),t.el.addEventListener("blur",function(e){t._onFieldBlur.call(t,e)}),t.el.addEventListener("input",function(e){t._onFieldInput.call(t,e)}),t.el.addEventListener("keydown",function(e){t._onKeyDown.call(t,e)}),t.el.addEventListener("keypress",function(e){t._onKeyPress.call(t,e)}),t._onFieldInput()}var r=l(2),i=l(5);a.prototype=Object.create(i.prototype),a.prototype.constructor=a,a.prototype._onKeyDown=function(e){var t=this;console.log(e.target.value),e.key||e.target.setAttribute("no-e-key","");var l=e.key||String.fromCharCode(e.which);return!e.key&&(e.which<46&&32!=e.which||e.which>111&&e.which<=123)||void(t._allowedCharacters&&(1!=l.length||t._isValidCharacter(l)&&t._checkLimitedCharacter(l)||e.preventDefault()))},a.prototype._onKeyPress=function(e){console.log(e.target.value)},a.prototype.setAllowedCharacters=function(e){var t=this;t._allowedCharacters=new RegExp(e,"g")},a.prototype.setLimitedCharacters=function(e){var t=this;t._limitedCharacters=e},a.prototype._isValidCharacter=function(e){var t=this;return!t._allowedCharacters||!!e.match(t._allowedCharacters)},a.prototype._checkLimitedCharacter=function(e){var t=this;if(!t._limitedCharacters)return!0;for(c in t._limitedCharacters){var l=t._limitedCharacters[c];if(l&&("number"==typeof l||"number"==typeof l.limit)){var a=new RegExp(l.re,"g")||new RegExp(e,"g");if(e.match(a)){var r=(l.limit||l,t.value.toString().match(a));return!r||r.length<l.limit}}}return!0},a.prototype._onFieldInput=function(e){var t=this;e&&console.log(e.target.hasAttribute("no-e-key")),t.value=t.valueParse(t.el.value),t.wrapperEl&&(""!==t.value?t.wrapperEl.classList.add(r.prefixClass("field-has-content")):t.wrapperEl.classList.remove(r.prefixClass("field-has-content")))},e.exports=a},function(e,t,l){function a(e){var t=this,l=document.createElement("div");l.classList.add(r.prefixClass("field-wrapper"));var a=e.elementTag||"input";t.name=e.key;var i=e.inputName||e.key,s=document.createElement(a);if(s.setAttribute("name",i),s.setAttribute("id",e.key),e.placeholder&&(s.setAttribute("placeholder",e.placeholder||""),l.classList.add(r.prefixClass("field-has-placeholder"))),e.disabled&&s.setAttribute("disabled",""),e.val&&(s.setAttribute("value",e.val),l.classList.add(r.prefixClass("field-has-content"))),s.classList.add(r.prefixClass("field")),t.el=s,t.wrapperEl=l,l.appendChild(t.el),e.label!==!1){var n=document.createElement("label");n.setAttribute("for",e.key),n.innerText=e.label||e.key,n.classList.add(r.prefixClass("label")),l.appendChild(n),t.labelEl=n}}var r=l(2);a.prototype._onFieldFocus=function(e){var t=this;t.wrapperEl&&t.wrapperEl.classList.add(r.prefixClass("field-focused"))},a.prototype._onFieldBlur=function(e){var t=this;t.wrapperEl&&t.wrapperEl.classList.remove(r.prefixClass("field-focused"))},a.prototype.valueParse=function(e){return e},e.exports=a},function(e,t,l){function a(e){var t=this;t.valueParse=function(e){return""!==e?parseInt(e):""},i.call(t,e),t.el.classList.add(r.prefixClass("field--integer")),t.setAllowedCharacters(/\d/)}var r=l(2),i=l(4);a.prototype=Object.create(i.prototype),a.prototype.constructor=a,e.exports=a},function(e,t,l){function a(e){var t=this;t.valueParse=function(e){return""!==e?parseFloat(e):""},i.call(t,e),t.el.classList.add(r.prefixClass("field--decimal")),t.setAllowedCharacters(/[\d\.]/),t.setLimitedCharacters({".":{re:/\./,limit:1}})}var r=l(2),i=l(4);a.prototype=Object.create(i.prototype),a.prototype.constructor=a,e.exports=a},function(e,t,l){function a(e){var t=this;t.valueParse=function(e){var t=this;return t.el.checked},i.call(t,e),t.el.setAttribute("type","checkbox"),t.el.classList.add(r.prefixClass("field--boolean")),t.labelEl.classList.add(r.prefixClass("label--boolean")),t.wrapperEl.classList.add(r.prefixClass("field-wrapper--no-underline"))}var r=l(2),i=l(9);a.prototype=Object.create(i.prototype),a.prototype.constructor=a,e.exports=a},function(e,t,l){function a(e){var t=this;i.call(t,e),t.wrapperEl.classList.remove(r.prefixClass("field-has-content")),t.wrapperEl.classList.remove(r.prefixClass("field-has-placeholder")),t.el.addEventListener("change",function(e){t._onFieldChange.call(t,e)}),t._onFieldChange&&t._onFieldChange()}var r=l(2),i=l(5);a.prototype=Object.create(i.prototype),a.prototype.constructor=a,a.prototype._onFieldChange=function(e){var t=this;t.value=t.valueParse(t.el.value)},e.exports=a},function(e,t,l){function a(e){var t=this;t.value=t.value||"",t._onFieldChange=function(e){t.value=e.target.value},i.call(t,e),t.labelEl.classList.add(r.prefixClass("label--choice")),t.wrapperEl.classList.add(r.prefixClass("field-wrapper--no-underline")),t.wrapperEl.addEventListener("change",function(e){t._onFieldChange.call(t,e)})}var r=l(2),i=l(11);a.prototype=Object.create(i.prototype),a.prototype.constructor=a,e.exports=a},function(e,t,l){function a(e){var t=this,l=document.createElement("div");if(l.classList.add(r.prefixClass("field-wrapper")),t.wrapperEl=l,e.label!==!1){var a=document.createElement("label");a.setAttribute("for",e.inputName||e.key),a.innerText=e.label||e.key,a.classList.add(r.prefixClass("label")),l.appendChild(a),t.labelEl=a}t._choiceFields=[];for(var s=0;s<e.choices.length;s++){var n={inputName:e.inputName||e.key,key:(e.inputName||e.key)+"["+s+"]",val:e.choices[s][0],label:e.choices[s][1]},o=new i(n);t.wrapperEl.appendChild(o.wrapperEl),t._choiceFields.push(o)}if(e.val)for(var s=0;s<t._choiceFields.length;s++)t._choiceFields[s].el.value==e.val&&(t._choiceFields[s].el.checked=!0)}var r=l(2),i=l(12);e.exports=a},function(e,t,l){function a(e){var t=this;i.call(t,e),t.el.setAttribute("type","radio"),t.el.classList.add(r.prefixClass("field--radio")),t.labelEl.classList.add(r.prefixClass("label--radio")),t.wrapperEl.classList.add(r.prefixClass("field-wrapper--no-underline"))}var r=l(2),i=l(9);a.prototype=Object.create(i.prototype),a.prototype.constructor=a,e.exports=a},function(e,t,l){function a(e){var t=this;t._onFieldChange=function(e){if(t._clearFileList(),t.multiple){if(t.el.files){for(var l=0;l<t.el.files.length;l++)t._addFileToList(t.el.files[l],l);t.wrapperEl.classList.add(r.prefixClass("has-files--multiple"))}}else t.el.files&&(t.labelEl.innerText=t.el.files[0].name,t.wrapperEl.classList.add(r.prefixClass("has-files")))},t._labelText=e.label||e.key,t.multiple=e.multiple||!1,i.call(t,e),t.el.setAttribute("type","file"),t.multiple&&t.el.setAttribute("multiple",""),t.el.classList.add(r.prefixClass("field--file")),t.labelEl.classList.add(r.prefixClass("label--file")),t.labelEl.innerText="Click to upload",t.wrapperEl.classList.add(r.prefixClass("field-wrapper--no-underline"));var l=document.createElement("label");l.classList.add(r.prefixClass("label--plain")),l.innerText=t._labelText,l.setAttribute("for",e.inputName||e.key),t.wrapperEl.insertBefore(l,t.el);var a=document.createElement("button");a.setAttribute("type","button"),a.classList.add(r.prefixClass("button")),a.classList.add(r.prefixClass("button--file-clear")),a.innerText="Ã—",a.addEventListener("click",function(e){t._resetFiles.call(t,e)}),t.wrapperEl.appendChild(a);var s=document.createElement("ul");s.classList.add(r.prefixClass("file-list")),t.wrapperEl.appendChild(s),t.fileListEl=s}var r=l(2),i=l(9);a.prototype=Object.create(i.prototype),a.prototype.constructor=a,a.prototype._addFileToList=function(e,t){var l=this,a=document.createElement("li");a.innerText=e.name,a.setAttribute("data-i",t),l.fileListEl.appendChild(a)},a.prototype._clearFileList=function(){var e=this;if(e.multiple){if(e.fileListEl)for(;e.fileListEl.firstChild;)e.fileListEl.removeChild(e.fileListEl.firstChild)}else e.labelEl.innerText="Click to upload";e.wrapperEl.classList.remove(r.prefixClass("has-files"))},a.prototype._resetFiles=function(){var e=this;e.el.value="",e._clearFileList()},a.prototype._onRemoveButtonClick=function(e){var t=this,l=e.target.parentNode.getAttribute("data-i");l=parseInt(l),console.log(t.el.files.splice(l,0))},e.exports=a},function(e,t,l){function a(e){var t=this;t.valueParse=function(e){var t=new Date(e);return console.log(t),e},i.call(t,e),t.el.classList.add(r.prefixClass("field--date")),t.setAllowedCharacters(/[\d-\/ ]/),t.setLimitedCharacters({separator:{re:/[-\/ ]/,limit:2}})}var r=l(2),i=l(4);a.prototype=Object.create(i.prototype),a.prototype.constructor=a,e.exports=a},function(e,t){function l(e){var t=this;if(t.method=e.method||"GET",t.url=e.url,t.url||console.warn("URL not specified"),t._xhr=new XMLHttpRequest,t._xhr.onload=function(e){var l=e.target.responseText;try{l=JSON.parse(l)}catch(e){}finally{t._successCallback&&t._successCallback.call({},l)}},t._xhr.open(t.method,t.url),e.headers)for(header in e.headers)t._xhr.setRequestHeader(header,e.headers[header]);return e.data?t._xhr.send(e.data):t._xhr.send(),t.success=function(e){t._successCallback=e},t}e.exports=l},function(e,t){function l(){var e=(new Date).getTime(),t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var l=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?l:3&l|8).toString(16)});return t}e.exports=l}]);